@model IEnumerable<ASM_WebBanNuocUong.Controllers.CartController.CartItem>

<div class="container mt-5">
    <h2 class="fw-bold mb-4"><i class="fas fa-shopping-basket me-2"></i>Giỏ hàng của bạn</h2>
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                <table class="table align-middle mb-0">
                    <thead class="bg-light">
                        <tr>
                            <th class="ps-4">Món nước</th>
                            <th>Đơn giá</th>
                            <th>Số lượng</th>
                            <th>Thành tiền</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model != null && Model.Any())
                        {
                            foreach (var item in Model)
                            {
                                <tr>
                                    <td class="ps-4 py-3">
                                        <div class="d-flex align-items-center">
                                            @* Ưu tiên hiện ảnh theo tên món nếu HinhAnh bị null *@
                                            <img src="/img/@(string.IsNullOrEmpty(item.HinhAnh) ? (item.TenSanPham.ToLower().Contains("matcha") ? "matcha đá xay.jpg" : "cà phê đen.jpg") : item.HinhAnh)" 
                                                 style="width: 60px; height: 60px; object-fit: cover;" class="rounded-3 me-3"
                                                 onerror="this.src='/img/matcha đá xay.jpg'">
                                            <div>
                                                <h6 class="fw-bold mb-0">@item.TenSanPham</h6>
                                                <small class="text-muted">Size L</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>@item.Gia.ToString("N0")đ</td>
                                    <td>@item.SoLuong</td>
                                    <td class="text-danger fw-bold">@item.ThanhTien.ToString("N0")đ</td>
                                    <td><a asp-action="Remove" asp-route-id="@item.MaSanPham" class="text-danger"><i class="fas fa-trash"></i></a></td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr><td colspan="5" class="text-center py-5">Giỏ hàng đang trống. <a href="/">Mua ngay</a></td></tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card border-0 shadow-lg rounded-4 p-4 text-center">
                <h5 class="fw-bold mb-3">Tóm tắt đơn hàng</h5>
                <h3 class="text-danger fw-bold">@(((decimal?)ViewBag.TongTien ?? 0).ToString("N0"))đ</h3>
                <hr>
                <button class="btn btn-dark w-100 rounded-pill py-2 mt-2" style="background-color: #5D4037; border: none;">XÁC NHẬN ĐẶT HÀNG</button>
            </div>
        </div>
    </div>
</div>